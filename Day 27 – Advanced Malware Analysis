Day 27 â€“ Advanced Malware Analysis
ðŸ”¹ 1. What is Advanced Malware Analysis?

Goal â†’ Understand malware behavior, persistence methods, IOCs, and create detection signatures.

Two types of malware analysis:

Static Analysis â†’ Inspect file without running (hash, strings, PE headers).

Dynamic Analysis â†’ Execute malware in sandbox to observe behavior.

ðŸ”¹ 2. Key Tools
Tool	Purpose
VirusTotal / Hybrid Analysis	Online malware scanning & sandbox
Cuckoo Sandbox / Any.Run	Dynamic malware execution & monitoring
ProcMon (Sysinternals)	Monitor process activity (registry, files, network)
Wireshark	Capture network traffic generated by malware
YARA Rules	Detect malware based on patterns/signatures
IDA / Ghidra	Reverse engineering for advanced static analysis
ðŸ”¹ 3. Behavioral Analysis (Dynamic)

Run malware sample in isolated sandbox VM.

Observe:

New files created

Registry changes

Network connections (IP/DNS requests)

Persistence (startup, services)

Extract IOCs (Indicators of Compromise):

File hashes (MD5/SHA256)

Malicious domains/IPs

Registry keys

ðŸ”¹ 4. YARA Rules for Detection

Example YARA Rule:

rule Suspicious_Powershell_Malware {
    meta:
        description = "Detects suspicious PowerShell malware"
    strings:
        $ps1 = "powershell -nop -w hidden"
        $url = "http://malicious.com"
    condition:
        any of them
}


Save rule â†’ malware_rules.yar

Test against sample file:

yara -r malware_rules.yar suspicious.exe

ðŸ”¹ 5. Practical Tasks
Task A: Static Analysis

Upload malware sample to VirusTotal

Extract: File hash, signatures, detection engines
ðŸ“¸ Screenshot â†’ Day27_Malware/static_analysis.png

Task B: Dynamic Analysis (Sandbox)

Run malware in Any.Run / Cuckoo Sandbox

Observe process tree, network traffic, registry modifications

Save sandbox report
ðŸ“¸ Screenshot â†’ Day27_Malware/dynamic_report.png

Task C: Network Analysis with Wireshark

Capture traffic generated by malware

Look for:

Suspicious domains

C2 server IPs

Unusual ports (e.g., 4444, 1337)
ðŸ“¸ Screenshot â†’ Day27_Malware/wireshark_capture.png

Task D: Create YARA Rule

Write detection rule for malware

Save file: Day27_Malware/malware_rules.yar
ðŸ“„ Save hunting report: Day27_Malware/malware_analysis_report.md

ðŸ”¹ 6. Key Takeaways

Learned static + dynamic malware analysis âœ…

Used sandbox, ProcMon, Wireshark âœ…

Created YARA rule for malware detection âœ…

Extracted IOCs for SOC use âœ…
