Day 18 â€“ Endpoint Security & Sysmon (Windows Logging Deep Dive)
ðŸ”¹ 1. What is Endpoint Security?

Endpoint Security = Protecting computers, servers, laptops, and other devices from malware, exploits, and unauthorized access.

Endpoint security tools provide:

Antivirus / Anti-malware protection

EDR (Endpoint Detection & Response)

Logging for SOC analysis

ðŸ”¹ 2. What is Sysmon?

Sysmon (System Monitor) = Windows system service that logs detailed info about system activity.

Part of Microsoft Sysinternals suite.

Key Features:

Logs process creation (with command line)

Logs network connections

Logs file creation and hashes

Helps detect malware/attacker activity

ðŸ”¹ 3. Key Sysmon Events
Event ID	Description
1	Process creation (includes command line)
2	File creation time changed
3	Network connection detected
5	Process terminated
7	Registry object changed
10	File created/modified with hash info
11	File deletion
ðŸ”¹ 4. Practical Tasks
Task A: Install Sysmon

Download Sysmon from https://docs.microsoft.com/en-us/sysinternals/downloads/sysmon

Install with default logging:

sysmon -i -accepteula
sysmon -c sysmonconfig-export.xml


Verify installation:

sysmon -c


ðŸ“¸ Screenshot â†’ Day18_Sysmon/sysmon_installed.png

Task B: Log Process Creation

Run a test program (e.g., Notepad, Calculator).

Open Event Viewer â†’ Applications and Services Logs â†’ Microsoft â†’ Windows â†’ Sysmon â†’ Operational

Check Event ID 1 â†’ Process creation details (command line, user, timestamp)
ðŸ“¸ Screenshot â†’ Day18_Sysmon/process_creation.png

Task C: Log Network Connections

Open browser â†’ visit http://example.com

Check Event ID 3 in Sysmon logs â†’ shows network connections
ðŸ“¸ Screenshot â†’ Day18_Sysmon/network_connection.png

Task D: Capture File Creation & Hash

Create a text file:

echo "SOC Practice" > test.txt


Check Event ID 10 â†’ shows file hash & creation
ðŸ“¸ Screenshot â†’ Day18_Sysmon/file_hash.png

Task E: Hunting with Sysmon Logs

Use Splunk/ELK â†’ ingest Sysmon logs

Search for suspicious process or network connection:

index=sysmon EventCode=1 Image="*powershell.exe"


Flag unusual or unknown processes

ðŸ“¸ Screenshot â†’ Day18_Sysmon/splunk_sysmon_hunt.png

ðŸ”¹ 5. Best Practices for Endpoint Security

Always update antivirus & EDR tools

Monitor Sysmon logs in SIEM

Detect rare processes, network connections, or unusual hashes

Isolate suspicious endpoints quickly

ðŸ”¹ 6. Key Takeaways

Learned what endpoint security is and its importance âœ…

Installed and configured Sysmon âœ…

Monitored process, network, and file activities âœ…

Integrated Sysmon logs into SIEM for hunting & detection âœ…
